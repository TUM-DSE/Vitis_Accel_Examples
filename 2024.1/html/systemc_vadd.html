


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="_static/js/gtm.js"></script>
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="_static/js/linkid.js"></script>
    <script type="text/javascript" src="_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="AIE Bare-Metal Emulation Test" href="aie_baremetal.html" />
    <link rel="prev" title="Functional Hardware Emulation (MM &amp; Streaming HLS C/C++ Kernel)" href="mm_stream_func_mode.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Vitis Accel Examples
          

          
          </a>

          
            
            
              <div class="version">
                2022.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="shells.html">Supported Shells</a></li>
<li class="toctree-l1"><a class="reference internal" href="compile_execute.html">Compilation and Execution</a></li>
</ul>
<p class="caption"><span class="caption-text">Category of Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hello_world.html">Hello World</a></li>
<li class="toctree-l1"><a class="reference internal" href="aie_kernels.html">AIE Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="host.html">Host OpenCL</a></li>
<li class="toctree-l1"><a class="reference internal" href="host_xrt.html">Host Native XRT</a></li>
<li class="toctree-l1"><a class="reference internal" href="host_py.html">Host Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="cpp.html">C++ Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Demos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="emulation.html">Emulation Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aie_adder_hybrid_swemu.html">AIE Adder Hybrid SW Emulation using x86 PS</a></li>
<li class="toctree-l2"><a class="reference internal" href="aie_adder_ps_on_x86.html">AIE Adder Embedded SW-Emulation using x86 PS</a></li>
<li class="toctree-l2"><a class="reference internal" href="aie_func_mode.html">AIE App with PL as HLS functional kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_io_cpp.html">External IO C++ based generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_io_py.html">External IO Python based generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="mm_stream_func_mode.html">Functional Hardware Emulation (MM &amp; Streaming HLS C/C++ Kernel)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SystemC Vadd</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#writing-ap-ctrl-hs-systemc-kernel-vadd">Writing ap_ctrl_hs SystemC kernel (vadd)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xtlm-ap-ctrl-hs-base-class">xtlm_ap_ctrl_hs base class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-kernel-interfaces">Adding kernel interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bridge-b-w-kernel-arguments-and-xrt-control">Bridge b/w Kernel arguments and XRT control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reading-and-writing-through-kernel-interfaces">Reading and Writing through kernel interfaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#putting-together-complete-vadd-systemc-pl-kernel-code">Putting together complete vadd SystemC PL kernel code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generating-xo-s-using-systemc-pl-kernel-source">Generating XO’s using SystemC PL kernel source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#design-files">DESIGN FILES</a></li>
<li class="toctree-l3"><a class="reference internal" href="#command-line-arguments">COMMAND LINE ARGUMENTS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="aie_baremetal.html">AIE Bare-Metal Emulation Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="deadlock_streaming_k2k_mm.html">System Deadlock Detection: Stream Kernel to Kernel Memory Mapped</a></li>
<li class="toctree-l2"><a class="reference internal" href="platform_validate.html">Platform Validate Bare-Metal Emulation Test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="sys_opt.html">System Optimization Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="sys_compiler.html">System Compiler Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="rtl.html">RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="ocl.html">OpenCL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate.html">Validate</a></li>
<li class="toctree-l1"><a class="reference internal" href="x3h.html">X3 Hybrid Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Common Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Files</a></li>
</ul>
<p class="caption"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="master.html">Master (2022.2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Previous Versions</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="_sources/systemc_vadd.rst.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Vitis Accel Examples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="emulation.html">Emulation Examples</a> &raquo;</li>
        
      <li>SystemC Vadd</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/systemc_vadd.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="systemc-vadd">
<h1>SystemC Vadd<a class="headerlink" href="#systemc-vadd" title="Permalink to this headline">¶</a></h1>
<p>This is simple example of vector addition to describe usage of custom SystemC in Vitis Environment.</p>
<p><strong>KEY CONCEPTS:</strong> <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1393-vitis-application-acceleration/Working-with-SystemC-Models">SystemC</a></p>
<p><strong>KEYWORDS:</strong> <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1393-vitis-application-acceleration/Working-with-SystemC-Models">create_sc_xo</a>, <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1393-vitis-application-acceleration/Coding-a-SystemC-Model">xtlm_ap_ctrl_hs</a></p>
<p>There are three types of Vitis HLS kernels namely ap_ctrl_chain, ap_ctrl_hs and ap_ctrl_none. Corresponding to each of these HLS kernels user can write SystemC kernels using predefined constructs/macros. The difference b/w ap_ctrl_chain and ap_ctrl_hs is that user can start ap_ctrl_chain kernels repeatedly by writing to ap_continue bit. In this example there is ap_ctrl_hs kernel vadd which requires the XRT control to provide memory address and size of the data.</p>
<div class="section" id="writing-ap-ctrl-hs-systemc-kernel-vadd">
<h2>Writing ap_ctrl_hs SystemC kernel (vadd)<a class="headerlink" href="#writing-ap-ctrl-hs-systemc-kernel-vadd" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="xtlm-ap-ctrl-hs-base-class">
<h2>xtlm_ap_ctrl_hs base class<a class="headerlink" href="#xtlm-ap-ctrl-hs-base-class" title="Permalink to this headline">¶</a></h2>
<p>The Kernels which requires XRT control should be derived from the xsc::xtlm_ap_ctrl_hs base class. xtlm_ap_ctrl_hs models all the control registers and AXI lite control interface. This class also has the ap_rst_n and ap_clk interfaces which are required as part of kernel interface requirements.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="o">:</span><span class="n">number</span><span class="o">-</span><span class="nl">lines</span><span class="p">:</span> <span class="mi">1</span>

     <span class="c1">//! deriving from xtlm_ap_ctrl_hs</span>
      <span class="k">class</span> <span class="nc">vadd</span> <span class="o">:</span> <span class="k">public</span> <span class="n">xsc</span><span class="o">::</span><span class="n">xtlm_ap_ctrl_hs</span>
          <span class="p">{</span>
          <span class="k">public</span><span class="o">:</span>
              <span class="n">SC_HAS_PROCESS</span><span class="p">(</span><span class="n">vadd</span><span class="p">);</span>
              <span class="n">vadd</span><span class="p">(</span><span class="n">sc_module_name</span> <span class="n">name</span><span class="p">,</span> <span class="n">xsc</span><span class="o">::</span><span class="n">common_cpp</span><span class="o">::</span><span class="n">properties</span><span class="o">&amp;</span> <span class="n">_properties</span><span class="p">)</span><span class="o">:</span>
              <span class="n">xsc</span><span class="o">::</span><span class="n">xtlm_ap_ctrl_hs</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
              <span class="p">{</span>
              <span class="p">.</span>
              <span class="p">.</span>
              <span class="p">}</span>
          <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-kernel-interfaces">
<h2>Adding kernel interfaces<a class="headerlink" href="#adding-kernel-interfaces" title="Permalink to this headline">¶</a></h2>
<p>Add the kernel interfaces by using below macros. The name of the interfaces used in the declaration will be reflected in component.xml which is generated from create_sc_xo command.
The same interfaces should be instantiated in the constructor of the model which is shown in below code snippet</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//Declare kernel interfaces</span>
 <span class="n">DECLARE_XTLM_AXIMM_MASTER_IF</span><span class="p">(</span><span class="n">in1</span><span class="p">);</span>
 <span class="n">DECLARE_XTLM_AXIMM_MASTER_IF</span><span class="p">(</span><span class="n">in2</span><span class="p">);</span>
 <span class="n">DECLARE_XTLM_AXIMM_MASTER_IF</span><span class="p">(</span><span class="n">out_r</span><span class="p">);</span>

<span class="c1">// Define interfaces inside constructor</span>
<span class="p">{</span>
    <span class="n">DEFINE_XTLM_AXIMM_MASTER_IF</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
    <span class="n">DEFINE_XTLM_AXIMM_MASTER_IF</span><span class="p">(</span><span class="n">in2</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
    <span class="n">DEFINE_XTLM_AXIMM_MASTER_IF</span><span class="p">(</span><span class="n">out_r</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="bridge-b-w-kernel-arguments-and-xrt-control">
<h2>Bridge b/w Kernel arguments and XRT control<a class="headerlink" href="#bridge-b-w-kernel-arguments-and-xrt-control" title="Permalink to this headline">¶</a></h2>
<p>If the kernel has the kernel arguments, the XRT needs to configure all these kernel arguments before starting the kernel. The first four 32 bit locations are reserved for predefined registers(CTRL, GIE, IE and IS) . From 0x10 onwards the addresses can be allocated to kernel arguments. If the kernel has arguments declare them with offset addresses(&gt;=0x10) and its size. Each arguments should be placed at multiple of 0x8 (0x10, 0x18, 0x20 etc). Using this information the kernel.xml file is generated and which acts as bridge between XRT and SystemC PL kernel. Once the ap_start is triggered the user can get the arguments configured by XRT as shown below in code snippet.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">//! Below lines adds link b/w XRT and IP through kernel.xml</span>
 <span class="n">ADD_MEMORY_IF_ARG</span><span class="p">(</span><span class="n">in1</span><span class="p">,</span>   <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">);</span>
 <span class="n">ADD_MEMORY_IF_ARG</span><span class="p">(</span><span class="n">in2</span><span class="p">,</span>   <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">);</span>
 <span class="n">ADD_MEMORY_IF_ARG</span><span class="p">(</span><span class="n">out_r</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x8</span><span class="p">);</span>
 <span class="n">ADD_SCALAR_ARG</span><span class="p">(</span><span class="n">size</span><span class="p">,</span>     <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x4</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="reading-and-writing-through-kernel-interfaces">
<h2>Reading and Writing through kernel interfaces<a class="headerlink" href="#reading-and-writing-through-kernel-interfaces" title="Permalink to this headline">¶</a></h2>
<p>The actual computation of the kernel is executed in SystemC thread “main_thread”. This thread waits until all kernel arguments are configured by XRT and start bit is set. Once thread comes out of wait(ev_ap_start), get the required kernel argument values. For each of the kernel interface types simple read/write API’s are provided which takes char* data type. Depending on the interface size, number bytes are read/write from char* as shown in below code snippet. Once the kernel execution is completed ap_done sets the appropriate bits (ap_done/ap_ready) and raises interrupt if enabled.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>  <span class="c1">//! Reading/Writing through kernel interfaces</span>
    <span class="kt">void</span> <span class="nf">main_thread</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">wait</span><span class="p">(</span><span class="n">ev_ap_start</span><span class="p">);</span> <span class="c1">//! Wait on ap_start event...</span>

    <span class="c1">//! Copy kernel args configured by host...</span>
    <span class="kt">uint64_t</span>  <span class="n">in1_base_addr</span> <span class="o">=</span> <span class="n">kernel_args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kt">uint64_t</span>  <span class="n">in2_base_addr</span> <span class="o">=</span> <span class="n">kernel_args</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kt">uint64_t</span>  <span class="n">out_r_base_addr</span> <span class="o">=</span> <span class="n">kernel_args</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">kernel_args</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

    <span class="kt">unsigned</span> <span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">data_r</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">in1</span><span class="o">-&gt;</span><span class="n">read</span><span class="p">(</span><span class="n">in1_base_addr</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">data1</span><span class="p">);</span>  <span class="c1">//! Read from in1 interface</span>
        <span class="n">in2</span><span class="o">-&gt;</span><span class="n">read</span><span class="p">(</span><span class="n">in2_base_addr</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">data2</span><span class="p">);</span>  <span class="c1">//! Read from in2 interface</span>

        <span class="c1">//! Add data1 &amp; data2 and write back result</span>
        <span class="n">data_r</span> <span class="o">=</span> <span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span><span class="p">;</span>                <span class="c1">//! Add</span>
        <span class="n">out_r</span><span class="o">-&gt;</span><span class="n">write</span><span class="p">(</span><span class="n">out_r_base_addr</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">data_r</span><span class="p">);</span> <span class="c1">//! Write the result</span>
    <span class="p">}</span>

    <span class="n">ap_done</span><span class="p">();</span> <span class="c1">//! completed Kernel computation...</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="putting-together-complete-vadd-systemc-pl-kernel-code">
<h2>Putting together complete vadd SystemC PL kernel code<a class="headerlink" href="#putting-together-complete-vadd-systemc-pl-kernel-code" title="Permalink to this headline">¶</a></h2>
<p>Below are the required steps to write the SystemC PL kernel</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="o">-</span>  <span class="n">Include</span> <span class="n">header</span> <span class="n">files</span> <span class="s">&quot;xtlm_ap_ctrl.h&quot;</span> <span class="n">and</span> <span class="s">&quot;xtlm.h&quot;</span><span class="p">.</span>
<span class="o">-</span>  <span class="n">Derive</span> <span class="n">from</span> <span class="n">predefined</span> <span class="n">base</span> <span class="k">class</span> <span class="nc">based</span> <span class="n">on</span> <span class="n">the</span> <span class="n">kernel</span> <span class="n">type</span><span class="p">(</span><span class="n">ap_ctrl_hs</span><span class="p">,</span> <span class="n">ap_ctrl_none</span> <span class="n">etc</span><span class="p">..).</span>
<span class="o">-</span>  <span class="n">Declare</span> <span class="o">&amp;</span> <span class="n">define</span> <span class="n">required</span> <span class="n">kernel</span> <span class="n">interfaces</span>
<span class="o">-</span>  <span class="n">Add</span> <span class="n">required</span> <span class="n">kernel</span> <span class="n">arguments</span> <span class="n">with</span> <span class="n">right</span> <span class="n">offset</span> <span class="n">addresses</span> <span class="n">and</span> <span class="n">size</span>
<span class="o">-</span>  <span class="n">Write</span> <span class="n">the</span> <span class="n">kernel</span> <span class="n">body</span> <span class="n">in</span> <span class="n">main_thread</span>
</pre></div>
</div>
</div>
<div class="section" id="generating-xo-s-using-systemc-pl-kernel-source">
<h2>Generating XO’s using SystemC PL kernel source<a class="headerlink" href="#generating-xo-s-using-systemc-pl-kernel-source" title="Permalink to this headline">¶</a></h2>
<p>Generating XO from source file has many intermediate steps like generating packaging script, package_xo script etc.. It is not required for the user to bother about intermediate files unless there are any issues. To generate XO use create_sc_xo command. create_sc_xo command takes the SystemC PL kenel source file as input and creates IP and generates the XO which can be used to link in Vitis. Once source files for vadd are ready use create_sc_xo command to generate XO’s.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#create_sc_xo command in Makefile</span>
<span class="n">vadd</span><span class="p">.</span><span class="nl">xo</span><span class="p">:</span> <span class="n">vadd</span><span class="p">.</span><span class="n">cpp</span>
    <span class="n">create_sc_xo</span> <span class="n">vadd</span><span class="p">.</span><span class="n">cpp</span>
</pre></div>
</div>
<p><strong>EXCLUDED PLATFORMS:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>All NoDMA Platforms, i.e u50 nodma etc</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="design-files">
<h2>DESIGN FILES<a class="headerlink" href="#design-files" title="Permalink to this headline">¶</a></h2>
<p>Application code is located in the src directory. Accelerator binary files will be compiled to the xclbin directory. The xclbin directory is required by the Makefile and its contents will be filled during compilation. A listing of all the files in this example is shown below</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">src</span><span class="o">/</span><span class="n">host</span><span class="o">.</span><span class="n">cpp</span>
<span class="n">src</span><span class="o">/</span><span class="n">vadd</span><span class="o">.</span><span class="n">cpp</span>
</pre></div>
</div>
<p>Access these files in the github repo by <a class="reference external" href="https://github.com/Xilinx/Vitis_Accel_Examples/tree/master/emulation/systemc_vadd">clicking here</a>.</p>
</div>
<div class="section" id="command-line-arguments">
<h2>COMMAND LINE ARGUMENTS<a class="headerlink" href="#command-line-arguments" title="Permalink to this headline">¶</a></h2>
<p>Once the environment has been configured, the application can be executed by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">systemc_vadd</span> <span class="o">&lt;</span><span class="n">vadd</span> <span class="n">XCLBIN</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aie_baremetal.html" class="btn btn-neutral float-right" title="AIE Bare-Metal Emulation Test" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mm_stream_func_mode.html" class="btn btn-neutral float-left" title="Functional Hardware Emulation (MM &amp; Streaming HLS C/C++ Kernel)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2020, Xilinx
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>